@startuml Parser_Flowchart
title Flowchart Parser (Recursive Descent) - 2 Pola

skinparam activity {
    BackgroundColor<<start>> LightBlue
    BackgroundColor<<end>> LightGreen
    BackgroundColor<<decision>> LightYellow
    BackgroundColor<<attack>> LightCoral
    BackgroundColor<<safe>> LightGreen
}

start

:Terima Token dari Lexer;

:Panggil parse();

if (Ada pola\nQUOTE + OR?) then (Ya)
    :_parse_boolean_attack();
    :Buat SQLInjectionNode\n(BOOLEAN_BASED);
    :is_malicious = True;
else (Tidak)
    if (Ada pola\nQUOTE + COMMENT?) then (Ya)
        :_parse_comment_attack();
        :Buat SQLInjectionNode\n(COMMENT_BASED);
        :is_malicious = True;
    else (Tidak)
        :Buat SafeNode;
        :is_malicious = False;
    endif
endif

:Return AST;

stop

note right
  **Recursive Descent Parser**
  
  Setiap non-terminal dalam CFG
  menjadi satu fungsi:
  
  - parse() → SQLInjection
  - _parse_boolean_attack() → BooleanAttack
  - _parse_comment_attack() → CommentAttack
end note

@enduml
